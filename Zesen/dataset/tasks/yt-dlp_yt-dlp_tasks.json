{
  "tasks": [
    {
      "task_title": "Always extract audio",
      "task_description": "ä½¿ç”¨-xé€‰é¡¹æå–éŸ³é¢‘ã€‚",
      "example_code": null,
      "running_command": "yt-dlp -x",
      "expected_input": "https://www.youtube.com/watch?v=BaW_jenozKc",
      "expected_output": "Extracting audio..."
    },
    {
      "task_title": "Copy the mtime",
      "task_description": "ä½¿ç”¨--mtimeé€‰é¡¹ä¿å­˜è§†é¢‘çš„ä¿®æ”¹æ—¶é—´ã€‚",
      "example_code": null,
      "running_command": "yt-dlp --mtime",
      "expected_input": "https://www.youtube.com/watch?v=BaW_jenozKc",
      "expected_output": "Video downloaded with original mtime."
    },
    {
      "task_title": "Use a proxy",
      "task_description": "ä½¿ç”¨--proxyé€‰é¡¹é€šè¿‡ä»£ç†ä¸‹è½½è§†é¢‘ã€‚",
      "example_code": null,
      "running_command": "yt-dlp --proxy 127.0.0.1:3128",
      "expected_input": "https://www.youtube.com/watch?v=BaW_jenozKc",
      "expected_output": "Downloading through proxy..."
    },
    {
      "task_title": "Save videos in a specific directory",
      "task_description": "ä½¿ç”¨-oé€‰é¡¹å°†è§†é¢‘ä¿å­˜åˆ°æŒ‡å®šç›®å½•ã€‚",
      "example_code": null,
      "running_command": "yt-dlp -o ~/YouTube/%(title)s.%(ext)s",
      "expected_input": "https://www.youtube.com/watch?v=BaW_jenozKc",
      "expected_output": "Video saved to ~/YouTube/VideoTitle.ext."
    },
    {
      "task_title": "Parse metadata for title",
      "task_description": "ä½¿ç”¨--parse-metadataé€‰é¡¹è§£æå…ƒæ•°æ®å¹¶è®¾ç½®æ ‡é¢˜æ ¼å¼ã€‚",
      "example_code": null,
      "running_command": "yt-dlp --parse-metadata \"title:%(artist)s - %(title)s\"",
      "expected_input": "https://www.youtube.com/watch?v=BaW_jenozKc",
      "expected_output": "Video title set to 'Artist - Title'."
    },
    {
      "task_title": "Regex for description metadata",
      "task_description": "ä½¿ç”¨--parse-metadataé€‰é¡¹é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼è§£ææè¿°ã€‚",
      "example_code": null,
      "running_command": "yt-dlp --parse-metadata \"description:Artist - (?P<artist>.+)\"",
      "expected_input": "https://www.youtube.com/watch?v=BaW_jenozKc",
      "expected_output": "Artist metadata extracted."
    },
    {
      "task_title": "Set series name in title",
      "task_description": "ä½¿ç”¨--parse-metadataé€‰é¡¹å°†æ ‡é¢˜è®¾ç½®ä¸ºç³»åˆ—åç§°æ ¼å¼ã€‚",
      "example_code": null,
      "running_command": "yt-dlp --parse-metadata \"%((series)s S%(season_number)02dE%(episode_number)02d:%(title)s\"",
      "expected_input": "https://www.youtube.com/watch?v=BaW_jenozKc",
      "expected_output": "Title set to 'Series name S01E05: Title'."
    },
    {
      "task_title": "Prioritize uploader as artist",
      "task_description": "ä½¿ç”¨--parse-metadataé€‰é¡¹å°†ä¸Šä¼ è€…ä½œä¸ºè‰ºæœ¯å®¶å­—æ®µï¼Œå¹¶åµŒå…¥å…ƒæ•°æ®ã€‚",
      "example_code": null,
      "running_command": "yt-dlp --parse-metadata \"%((uploader|)s:%(meta_artist)s\" --embed-metadata",
      "expected_input": "https://www.youtube.com/watch?v=BaW_jenozKc",
      "expected_output": "Uploader set as artist in metadata."
    },
    {
      "task_title": "Set comment field using description",
      "task_description": "ä½¿ç”¨--parse-metadataé€‰é¡¹ç”¨æè¿°è®¾ç½®è¯„è®ºå­—æ®µã€‚",
      "example_code": null,
      "running_command": "yt-dlp --parse-metadata \"description:(?s)(?P<meta_comment>.+)\" --embed-metadata",
      "expected_input": "https://www.youtube.com/watch?v=BaW_jenozKc",
      "expected_output": "Comment field set in metadata."
    },
    {
      "task_title": "Do not set synopsis in metadata",
      "task_description": "ä½¿ç”¨--parse-metadataé€‰é¡¹ä¸è®¾ç½®ä»»ä½•ç®€ä»‹ã€‚",
      "example_code": null,
      "running_command": "yt-dlp --parse-metadata \":(?P<meta_synopsis>)\"",
      "expected_input": "https://www.youtube.com/watch?v=BaW_jenozKc",
      "expected_output": "No synopsis set in metadata."
    },
    {
      "task_title": "Remove formats field from infojson",
      "task_description": "ä½¿ç”¨--parse-metadataé€‰é¡¹å°†formatså­—æ®µè®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ä»¥ç§»é™¤ã€‚",
      "example_code": null,
      "running_command": "yt-dlp --parse-metadata \"video::(?P<formats>)\" --write-info-json",
      "expected_input": "https://www.youtube.com/watch?v=BaW_jenozKc",
      "expected_output": "Formats field removed from infojson."
    },
    {
      "task_title": "Replace spaces in metadata",
      "task_description": "ä½¿ç”¨--replace-in-metadataé€‰é¡¹æ›¿æ¢æ ‡é¢˜å’Œä¸Šä¼ è€…ä¸­çš„ç©ºæ ¼å’Œä¸‹åˆ’çº¿ã€‚",
      "example_code": null,
      "running_command": "yt-dlp --replace-in-metadata \"title,uploader\" \"[ _]\" \"-\"",
      "expected_input": "https://www.youtube.com/watch?v=BaW_jenozKc",
      "expected_output": "Spaces and underscores replaced with '-'."
    }
  ],
  "setup": {
    "setup_commands": [
      "INSTALLATION",
      "curl -L https://github.com/yt-dlp/yt-dlp/raw/master/public.key | gpg --import\ngpg --verify SHA2-256SUMS.sig SHA2-256SUMS\ngpg --verify SHA2-512SUMS.sig SHA2-512SUMS",
      "# To update to nightly from stable executable/binary:\nyt-dlp --update-to nightly\n\n# To install nightly with pip:\npython3 -m pip install -U --pre \"yt-dlp[default]\"",
      "$ yt-dlp --print filename -o \"test video.%(ext)s\" BaW_jenozKc\ntest video.webm    # Literal name with correct extension\n\n$ yt-dlp --print filename -o \"%(title)s.%(ext)s\" BaW_jenozKc\nyoutube-dl test video ''_Ã¤â†­ğ•.webm    # All kinds of weird characters\n\n$ yt-dlp --print filename -o \"%(title)s.%(ext)s\" BaW_jenozKc --restrict-filenames\nyoutube-dl_test_video_.webm    # Restricted file name\n\n# Download YouTube playlist videos in separate directory indexed by video order in a playlist\n$ yt-dlp -o \"%(playlist)s/%(playlist_index)s - %(title)s.%(ext)s\" \"https://www.youtube.com/playlist?list=PLwiyx1dc3P2JR9N8gQaQN_BCvlSlap7re\"\n\n# Download YouTube playlist videos in separate directories according to their uploaded year\n$ yt-dlp -o \"%(upload_date>%Y)s/%(title)s.%(ext)s\" \"https://www.youtube.com/playlist?list=PLwiyx1dc3P2JR9N8gQaQN_BCvlSlap7re\"\n\n# Prefix playlist index with \" - \" separator, but only if it is available\n$ yt-dlp -o \"%(playlist_index&{} - |)s%(title)s.%(ext)s\" BaW_jenozKc \"https://www.youtube.com/user/TheLinuxFoundation/playlists\"\n\n# Download all playlists of YouTube channel/user keeping each playlist in separate directory:\n$ yt-dlp -o \"%(uploader)s/%(playlist)s/%(playlist_index)s - %(title)s.%(ext)s\" \"https://www.youtube.com/user/TheLinuxFoundation/playlists\"\n\n# Download Udemy course keeping each chapter in separate directory under MyVideos directory in your home\n$ yt-dlp -u user -p password -P \"~/MyVideos\" -o \"%(playlist)s/%(chapter_number)s - %(chapter)s/%(title)s.%(ext)s\" \"https://www.udemy.com/java-tutorial\"\n\n# Download entire series season keeping each series and each season in separate directory under C:/MyVideos\n$ yt-dlp -P \"C:/MyVideos\" -o \"%(series)s/%(season_number)s - %(season)s/%(episode_number)s - %(episode)s.%(ext)s\" \"https://videomore.ru/kino_v_detalayah/5_sezon/367617\"\n\n# Download video as \"C:\\MyVideos\\uploader\\title.ext\", subtitles as \"C:\\MyVideos\\subs\\uploader\\title.ext\"\n# and put all temporary files in \"C:\\MyVideos\\tmp\"\n$ yt-dlp -P \"C:/MyVideos\" -P \"temp:tmp\" -P \"subtitle:subs\" -o \"%(uploader)s/%(title)s.%(ext)s\" BaW_jenozKc --write-subs\n\n# Download video as \"C:\\MyVideos\\uploader\\title.ext\" and subtitles as \"C:\\MyVideos\\uploader\\subs\\title.ext\"\n$ yt-dlp -P \"C:/MyVideos\" -o \"%(uploader)s/%(title)s.%(ext)s\" -o \"subtitle:%(uploader)s/subs/%(title)s.%(ext)s\" BaW_jenozKc --write-subs\n\n# Stream the video being downloaded to stdout\n$ yt-dlp -o - BaW_jenozKc",
      "# Download and merge the best video-only format and the best audio-only format,\n# or download the best combined format if video-only format is not available\n$ yt-dlp -f \"bv+ba/b\"\n\n# Download best format that contains video,\n# and if it doesn't already have an audio stream, merge it with best audio-only format\n$ yt-dlp -f \"bv*+ba/b\"\n\n# Same as above\n$ yt-dlp\n\n# Download the best video-only format and the best audio-only format without merging them\n# For this case, an output template should be used since\n# by default, bestvideo and bestaudio will have the same file name.\n$ yt-dlp -f \"bv,ba\" -o \"%(title)s.f%(format_id)s.%(ext)s\"\n\n# Download and merge the best format that has a video stream,\n# and all audio-only formats into one file\n$ yt-dlp -f \"bv*+mergeall[vcodec=none]\" --audio-multistreams\n\n# Download and merge the best format that has a video stream,\n# and the best 2 audio-only formats into one file\n$ yt-dlp -f \"bv*+ba+ba.2\" --audio-multistreams\n\n\n# The following examples show the old method (without -S) of format selection\n# and how to use -S to achieve a similar but (generally) better result\n\n# Download the worst video available (old method)\n$ yt-dlp -f \"wv*+wa/w\"\n\n# Download the best video available but with the smallest resolution\n$ yt-dlp -S \"+res\"\n\n# Download the smallest video available\n$ yt-dlp -S \"+size,+br\"\n\n\n\n# Download the best mp4 video available, or the best video if no mp4 available\n$ yt-dlp -f \"bv*[ext=mp4]+ba[ext=m4a]/b[ext=mp4] / bv*+ba/b\"\n\n# Download the best video with the best extension\n# (For video, mp4 > mov > webm > flv. For audio, m4a > aac > mp3 ...)\n$ yt-dlp -S \"ext\"\n\n\n\n# Download the best video available but no better than 480p,\n# or the worst video if there is no video under 480p\n$ yt-dlp -f \"bv*[height<=480]+ba/b[height<=480] / wv*+ba/w\"\n\n# Download the best video available with the largest height but no better than 480p,\n# or the best video with the smallest resolution if there is no video under 480p\n$ yt-dlp -S \"height:480\"\n\n# Download the best video available with the largest resolution but no better than 480p,\n# or the best video with the smallest resolution if there is no video under 480p\n# Resolution is determined by using the smallest dimension.\n# So this works correctly for vertical videos as well\n$ yt-dlp -S \"res:480\"\n\n\n\n# Download the best video (that also has audio) but no bigger than 50 MB,\n# or the worst video (that also has audio) if there is no video under 50 MB\n$ yt-dlp -f \"b[filesize<50M] / w\"\n\n# Download the largest video (that also has audio) but no bigger than 50 MB,\n# or the smallest video (that also has audio) if there is no video under 50 MB\n$ yt-dlp -f \"b\" -S \"filesize:50M\"\n\n# Download the best video (that also has audio) that is closest in size to 50 MB\n$ yt-dlp -f \"b\" -S \"filesize~50M\"\n\n\n\n# Download best video available via direct link over HTTP/HTTPS protocol,\n# or the best video available via any protocol if there is no such video\n$ yt-dlp -f \"(bv*+ba/b)[protocol^=http][protocol!*=dash] / (bv*+ba/b)\"\n\n# Download best video available via the best protocol\n# (https/ftps > http/ftp > m3u8_native > m3u8 > http_dash_segments ...)\n$ yt-dlp -S \"proto\"\n\n\n\n# Download the best video with either h264 or h265 codec,\n# or the best video if there is no such video\n$ yt-dlp -f \"(bv*[vcodec~='^((he|a)vc|h26[45])']+ba) / (bv*+ba/b)\"\n\n# Download the best video with best codec no better than h264,\n# or the best video with worst codec if there is no such video\n$ yt-dlp -S \"codec:h264\"\n\n# Download the best video with worst codec no worse than h264,\n# or the best video with best codec if there is no such video\n$ yt-dlp -S \"+codec:h264\"\n\n\n\n# More complex examples\n\n# Download the best video no better than 720p preferring framerate greater than 30,\n# or the worst video (still preferring framerate greater than 30) if there is no such video\n$ yt-dlp -f \"((bv*[fps>30]/bv*)[height<=720]/(wv*[fps>30]/wv*)) + ba / (b[fps>30]/b)[height<=720]/(w[fps>30]/w)\"\n\n# Download the video with the largest resolution no better than 720p,\n# or the video with the smallest resolution available if there is no such video,\n# preferring larger framerate for formats with the same resolution\n$ yt-dlp -S \"res:720,fps\"\n\n\n\n# Download the video with smallest resolution no worse than 480p,\n# or the video with the largest resolution available if there is no such video,\n# preferring better codec and then larger total bitrate for the same resolution\n$ yt-dlp -S \"+res:480,codec,br\"",
      "from yt_dlp import YoutubeDL\n\nURLS = ['https://www.youtube.com/watch?v=BaW_jenozKc']\nwith YoutubeDL() as ydl:\n    ydl.download(URLS)",
      "import json\nimport yt_dlp\n\nURL = 'https://www.youtube.com/watch?v=BaW_jenozKc'\n\n# â„¹ï¸ See help(yt_dlp.YoutubeDL) for a list of available options and public functions\nydl_opts = {}\nwith yt_dlp.YoutubeDL(ydl_opts) as ydl:\n    info = ydl.extract_info(URL, download=False)\n\n    # â„¹ï¸ ydl.sanitize_info makes the info json-serializable\n    print(json.dumps(ydl.sanitize_info(info)))",
      "import yt_dlp\n\nINFO_FILE = 'path/to/video.info.json'\n\nwith yt_dlp.YoutubeDL() as ydl:\n    error_code = ydl.download_with_info_file(INFO_FILE)\n\nprint('Some videos failed to download' if error_code\n      else 'All videos successfully downloaded')",
      "import yt_dlp\n\nURLS = ['https://www.youtube.com/watch?v=BaW_jenozKc']\n\nydl_opts = {\n    'format': 'm4a/bestaudio/best',\n    # â„¹ï¸ See help(yt_dlp.postprocessor) for a list of available Postprocessors and their arguments\n    'postprocessors': [{  # Extract audio using ffmpeg\n        'key': 'FFmpegExtractAudio',\n        'preferredcodec': 'm4a',\n    }]\n}\n\nwith yt_dlp.YoutubeDL(ydl_opts) as ydl:\n    error_code = ydl.download(URLS)",
      "import yt_dlp\n\nURLS = ['https://www.youtube.com/watch?v=BaW_jenozKc']\n\ndef longer_than_a_minute(info, *, incomplete):\n    \"\"\"Download only videos longer than a minute (or with unknown duration)\"\"\"\n    duration = info.get('duration')\n    if duration and duration < 60:\n        return 'The video is too short'\n\nydl_opts = {\n    'match_filter': longer_than_a_minute,\n}\n\nwith yt_dlp.YoutubeDL(ydl_opts) as ydl:\n    error_code = ydl.download(URLS)",
      "import yt_dlp\n\nURLS = ['https://www.youtube.com/watch?v=BaW_jenozKc']\n\nclass MyLogger:\n    def debug(self, msg):\n        # For compatibility with youtube-dl, both debug and info are passed into debug\n        # You can distinguish them by the prefix '[debug] '\n        if msg.startswith('[debug] '):\n            pass\n        else:\n            self.info(msg)\n\n    def info(self, msg):\n        pass\n\n    def warning(self, msg):\n        pass\n\n    def error(self, msg):\n        print(msg)\n\n\n# â„¹ï¸ See \"progress_hooks\" in help(yt_dlp.YoutubeDL)\ndef my_hook(d):\n    if d['status'] == 'finished':\n        print('Done downloading, now post-processing ...')\n\n\nydl_opts = {\n    'logger': MyLogger(),\n    'progress_hooks': [my_hook],\n}\n\nwith yt_dlp.YoutubeDL(ydl_opts) as ydl:\n    ydl.download(URLS)",
      "import yt_dlp\n\nURLS = ['https://www.youtube.com/watch?v=BaW_jenozKc']\n\n# â„¹ï¸ See help(yt_dlp.postprocessor.PostProcessor)\nclass MyCustomPP(yt_dlp.postprocessor.PostProcessor):\n    def run(self, info):\n        self.to_screen('Doing stuff')\n        return [], info\n\n\nwith yt_dlp.YoutubeDL() as ydl:\n    # â„¹ï¸ \"when\" can take any value in yt_dlp.utils.POSTPROCESS_WHEN\n    ydl.add_post_processor(MyCustomPP(), when='pre_process')\n    ydl.download(URLS)",
      "import yt_dlp\n\nURLS = ['https://www.youtube.com/watch?v=BaW_jenozKc']\n\ndef format_selector(ctx):\n    \"\"\" Select the best video and the best audio that won't result in an mkv.\n    NOTE: This is just an example and does not handle all cases \"\"\"\n\n    # formats are already sorted worst to best\n    formats = ctx.get('formats')[::-1]\n\n    # acodec='none' means there is no audio\n    best_video = next(f for f in formats\n                      if f['vcodec'] != 'none' and f['acodec'] == 'none')\n\n    # find compatible audio extension\n    audio_ext = {'mp4': 'm4a', 'webm': 'webm'}[best_video['ext']]\n    # vcodec='none' means there is no video\n    best_audio = next(f for f in formats if (\n        f['acodec'] != 'none' and f['vcodec'] == 'none' and f['ext'] == audio_ext))\n\n    # These are the minimum required fields for a merged format\n    yield {\n        'format_id': f'{best_video[\"format_id\"]}+{best_audio[\"format_id\"]}',\n        'ext': best_video['ext'],\n        'requested_formats': [best_video, best_audio],\n        # Must be + separated list of protocols\n        'protocol': f'{best_video[\"protocol\"]}+{best_audio[\"protocol\"]}'\n    }\n\n\nydl_opts = {\n    'format': format_selector,\n}\n\nwith yt_dlp.YoutubeDL(ydl_opts) as ydl:\n    ydl.download(URLS)"
    ],
    "docker_commands": [],
    "docker_files": {}
  },
  "input_to_gpt": {
    "repo_name": "yt-dlp/yt-dlp",
    "num_code_blocks": 8,
    "total_length": 1869,
    "code_blocks": [
      "python3 devscripts/install_deps.py --include pyinstaller\npython3 devscripts/make_lazy_extractors.py\npython3 -m bundle.pyinstaller",
      "# Lines starting with # are comments\n\n# Always extract audio\n-x\n\n# Copy the mtime\n--mtime\n\n# Use this proxy\n--proxy 127.0.0.1:3128\n\n# Save all videos under YouTube directory in your home directory\n-o ~/YouTube/%(title)s.%(ext)s",
      "touch ${HOME}/.netrc\nchmod a-rwx,u+rw ${HOME}/.netrc",
      "machine <extractor> login <username> password <password>",
      "machine youtube login myaccount@gmail.com password my_youtube_password\nmachine twitch login my_twitch_account_name password my_twitch_password",
      "yt-dlp --netrc-cmd 'gpg --decrypt ~/.authinfo.gpg' 'https://www.youtube.com/watch?v=BaW_jenozKc'",
      "%(name[.keys][addition][>strf][,alternate][&replacement][|default])[flags][width][.precision][length]type",
      "# Interpret the title as \"Artist - Title\"\n$ yt-dlp --parse-metadata \"title:%(artist)s - %(title)s\"\n\n# Regex example\n$ yt-dlp --parse-metadata \"description:Artist - (?P<artist>.+)\"\n\n# Set title as \"Series name S01E05\"\n$ yt-dlp --parse-metadata \"%(series)s S%(season_number)02dE%(episode_number)02d:%(title)s\"\n\n# Prioritize uploader as the \"artist\" field in video metadata\n$ yt-dlp --parse-metadata \"%(uploader|)s:%(meta_artist)s\" --embed-metadata\n\n# Set \"comment\" field in video metadata using description instead of webpage_url,\n# handling multiple lines correctly\n$ yt-dlp --parse-metadata \"description:(?s)(?P<meta_comment>.+)\" --embed-metadata\n\n# Do not set any \"synopsis\" in the video metadata\n$ yt-dlp --parse-metadata \":(?P<meta_synopsis>)\"\n\n# Remove \"formats\" field from the infojson by setting it to an empty string\n$ yt-dlp --parse-metadata \"video::(?P<formats>)\" --write-info-json\n\n# Replace all spaces and \"_\" in title and uploader with a `-`\n$ yt-dlp --replace-in-metadata \"title,uploader\" \"[ _]\" \"-\"\n"
    ]
  }
}