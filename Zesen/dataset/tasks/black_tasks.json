{
  "tasks": [
    {
      "task_title": "格式化Python代码",
      "task_description": "使用Black库对指定的文件或目录进行代码格式化。",
      "example_code": null,
      "running_command": "black {source_file_or_directory}",
      "expected_input": "source_file_or_directory",
      "expected_output": "Formatted code in the specified file or directory."
    },
    {
      "task_title": "格式化Python代码（模块方式）",
      "task_description": "通过Python模块方式调用Black库对指定的文件或目录进行代码格式化。",
      "example_code": null,
      "running_command": "python -m black {source_file_or_directory}",
      "expected_input": "source_file_or_directory",
      "expected_output": "Formatted code in the specified file or directory."
    }
  ],
  "setup": {
    "setup_commands": [],
    "docker_commands": [],
    "docker_files": {
      "Dockerfile": "FROM python:3.12-slim AS builder\n\nRUN mkdir /src\nCOPY . /src/\nENV VIRTUAL_ENV=/opt/venv\nENV HATCH_BUILD_HOOKS_ENABLE=1\n# Install build tools to compile black + dependencies\nRUN apt update && apt install -y build-essential git python3-dev\nRUN python -m venv $VIRTUAL_ENV\nRUN python -m pip install --no-cache-dir hatch hatch-fancy-pypi-readme hatch-vcs\nRUN . /opt/venv/bin/activate && pip install --no-cache-dir --upgrade pip setuptools \\\n    && cd /src && hatch build -t wheel \\\n    && pip install --no-cache-dir dist/*-cp* \\\n    && pip install black[colorama,d,uvloop]\n\nFROM python:3.12-slim\n\n# copy only Python packages to limit the image size\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\n\nCMD [\"/opt/venv/bin/black\"]\n"
    },
    "docker_setup_descriptions": {
      "Dockerfile": "To build and run the Docker image for the `psf/black` repository, follow these steps:\n\n### Purpose of the Image\nThe Docker image is designed to encapsulate the `black` code formatter for Python, providing a consistent environment for formatting Python code. It includes all necessary dependencies and tools required to run `black` effectively.\n\n### Building the Image\n1. **Base Image**: The build process starts from a lightweight Python 3.12 slim image, which minimizes the image size while still providing the necessary Python environment.\n\n2. **Setting Up the Build Environment**:\n   - A directory named `/src` is created to hold the source code.\n   - The entire content of the repository is copied into this directory.\n\n3. **Environment Variables**:\n   - The `VIRTUAL_ENV` variable is set to specify the location of the virtual environment.\n   - The `HATCH_BUILD_HOOKS_ENABLE` variable is enabled to allow for custom build hooks during the package build process.\n\n4. **Installing Build Tools**:\n   - Essential build tools and dependencies are installed, including `build-essential`, `git`, and `python3-dev`. These tools are necessary for compiling the `black` package and its dependencies.\n\n5. **Creating a Virtual Environment**:\n   - A Python virtual environment is created at the specified `VIRTUAL_ENV` location.\n\n6. **Installing Build Dependencies**:\n   - The `hatch`, `hatch-fancy-pypi-readme`, and `hatch-vcs` packages are installed to facilitate the building of the `black` package.\n\n7. **Building and Installing `black`**:\n   - The `pip` tool is upgraded, and then the `black` package is built and installed from the source code located in `/src`. This includes the installation of additional dependencies like `colorama`, `d`, and `uvloop`.\n\n### Final Image Creation\nAfter the build stage, a second slim Python 3.12 image is created. The virtual environment containing the installed `black` package is copied from the builder stage to this final image. The `PATH` environment variable is updated to include the virtual environment's `bin` directory, ensuring that the `black` command is easily accessible.\n\n### Running the Image\nTo run the Docker container, execute the command that invokes the `black` formatter. This command will utilize the installed `black` package within the virtual environment, allowing you to format Python files as needed.\n\n### Summary\nThis Docker image provides a streamlined, isolated environment for using the `black` code formatter, ensuring that all dependencies are correctly managed and that the tool can be executed without conflicts or issues related to the host system's Python environment."
    }
  },
  "input_to_gpt": {
    "repo_name": "psf/black",
    "num_code_blocks": 2,
    "total_length": 81,
    "code_blocks": [
      "black {source_file_or_directory}",
      "python -m black {source_file_or_directory}"
    ]
  }
}